# HOPE Automated Tests Documentation



## Features
- Page Object Model pattern
- Microsoft Teams Integration
- Detailed environment and status reporting to Microsoft Teams
- Configure which environment to run the tests via CLI
- Configurable environment variables
- Multiple reporting (Spec, JSON, Allure, & Timeline)
- Assert with Chai or Expect-webdriverio
- BDD User Story Declarative style pattern (Automation Tracker)
- Continuous Testing via Bitbucket Pipelines
- Uses latest Chrome browser on Continuous Testing

## Tools
### Frameworks
- WebdriverIO
- Mocha BDD
### Assertions
- Chai Expect
- WebdriverIO Expect
### Continuous Testing
- Bitbucket Pipelines
  - Running on Linux
### Reporters
- Spec
- JSON
- Allure
- Timeline

## Requirements
- Basic knowledge in JavaScript and NodeJS
- Node 12.18.4 or later versions
- Visual Studio Code or any preferred IDE
- Source Tree
- Git Bash
- Clone of latest master branch
  - git clone git@bitbucket.org:ADDIMedicalAB/hope-solution-v1_6.git
Chrome Browser

## Setup
- Open folder using IDE: root/src/automated-tests
- Install dependencies by running the following script on terminal
  - npm i
- Test if setup is complete by running the following script on terminal
  - npx wdio --spec login env=dev

## Directory Structure
- /data
  - Test data are stored here (information, images, etc.)
  - Test information are exportable modules
- /environments
  - /base-urls
    - Exportable module that contains base URLs of environments
  - /environments
    - Exportable module that contains environment keywords that will be compared to the CLI for configuring which environment the test to run
  - /environment-variables
    - Exportable module that contains environment variables and baseUrl that determines which environment to run and which environment variables to use. 

``Reports directory: Every test run, it is configured to delete all folders under Reports directory (This can be configured in onPrepare hook)``

- /reports
  - /allure
    - Stores files that are produced by running tests
    - To view report, run the following command on terminal
      - npm run report.allure
  - /errors
    - Stores image files generated by test fail scenarios
    - File name = {describe block name} “ THEN ” {it block name}
  - /json
    - Stores files that are produced by a single spec file or group of spec files
    - Contains the file (test-results.json) that Microsoft Teams Integration uses for reporting result to a channel
  - /logs
    - ``disk-space-availablility`` and ``provider-availability`` test writes a log file for results and stores it in this directory
  - /timeline
    - Contains all generated file from the Timeline Service reporter
    - Also generates an HTML file that contains results from recent test run

- /test
  - /helpers
    - /hook-urls
      - Contains the hooks from Microsoft Integration
      - To get a channel’s hook url
        - Select a Microsoft Teams channel
        - Click the (...) icon and select Connectors
        - Locate Incoming Hook and click Configure
        - Complete setup and copy the hook url
    - /random
        - Contains methods that generates random data
        - [ChanceJS Documentation](https://chancejs.com/)
    - /teams-reporter
        - File that processes /reports/json/test-results.json file and sends report to Microsoft Teams
- /pages
    - Page files contains the DOM (e.g. //button[@type=submit] for Login button)
    - Also contains methods for actions/processes that are repetitive (e.g. login process)
- /specs
    - Contains the actual test files
    - This is where the BDD User Story Declarative style is written
    - Uses Mocha’s Describe and IT BDD style
        - Describe block contains the User Story 
            - E.g. User can login with valid credentials
        - It block contains the steps or actions needed to suffice the User Story
            - Should navigate to Login page, 
            - Should be able to input on email and password input field
            - Should be able to login with valid credentials
            - Should be navigated to Dashboard page
    - ``/specs/monitoring/check-disk-available.spec``
        - Gets data of HOPE servers and reports to Microsoft Teams
            - Need a Grafana account. Create a .env file in the root and supply account with "GRAFANA_EMAIL=" and "GRAFANA_PASS="

- /package
    - Contains all project information, dependencies and custom scripts
- /wdio.conf
    - Contains project configurations
        - It is well-documented, information should be available in this file


## Notes
- Configured to run on Chrome only for now
- To use Chai Expect assertion, use `expectChai` keyword


## Running tests
Run automated disk check and reporting to ```Monitoring``` channel in Microsoft Teams
````
npm run test.check-disks
````
Run Regression Testing in Dev
````
npm run test.regression:dev
````
Run Regression Testing in Staging
````
npm run test.regression:staging
````
Run Regression Testing in Demo
````
npm run test.regression:demo
````
Run Regression Testing in Week-dev
````
npm run test.regression:weekdev
````

### Reports
Allure
````
npm run report.allure
````
Microsoft Teams 
````
npm run report.teams
````
Clean ```./reports/``` folder
````
npm clean
````

